<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Coding Quiz Platform</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
  .instruction-text { font-size: 1.15rem; line-height: 1.65rem; }
  .instruction-bullets { font-size: 1.05rem; line-height: 1.55rem; }
  #questionText { font-size: 1.05rem; line-height: 1.6; white-space: pre-line; }
  #optionsContainer label { font-size: 1rem; }
  button:disabled { opacity: 0.5; cursor: not-allowed; }
  input[type="radio"] { accent-color: #6366f1; }
</style>
</head>

<body class="min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 select-none">

<div class="w-full h-full min-h-screen bg-slate-900/85 backdrop-blur-xl shadow-xl text-slate-50 p-6 md:p-10 flex flex-col gap-6">

  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
    <div>
      <h1 class="text-3xl font-semibold tracking-tight">Coding Contest Quiz</h1>
      <p class="text-sm text-slate-400 mt-1">20 MCQs • 30 minutes • 2 marks each</p>
    </div>
    <div class="flex flex-col items-start md:items-end text-xs text-slate-400">
      <span>Department of CSE</span>
      <span class="text-slate-500">Proctored Competition Platform</span>
    </div>
  </div>

  <h2 class="text-center text-3xl font-bold text-indigo-400 mb-2 underline underline-offset-4 decoration-indigo-400">TECH RUSH</h2>

  <div id="startScreen" class="grid md:grid-cols-[2fr,1fr] gap-10 items-start">

    <div class="space-y-4">
      <p class="instruction-text text-slate-200">
        You will get <span class="font-semibold text-indigo-400 text-xl">30 minutes</span> to answer
        <span class="font-semibold text-indigo-400 text-xl">20 questions</span>.
        Once started, the timer and attempt cannot be paused.
      </p>

      <ul class="instruction-bullets text-slate-300 list-disc list-inside space-y-2">
        <li>Questions and options are shuffled uniquely for you.</li>
        <li>Use the question palette to navigate and mark questions for review.</li>
        <li>Switching tabs or exiting fullscreen will auto-submit your test.</li>
        <li>Copying, pasting, screenshots and opening inspect element are blocked.</li>
        <li>Do not press Print Screen — this will immediately submit the test.</li>
      </ul>
    </div>

    <div class="space-y-4 text-base text-slate-200 border border-slate-600 rounded-2xl p-6 bg-slate-900/60">
      <p class="font-semibold text-lg">Color Legend</p>
      <div class="flex items-center gap-3"><span class="w-5 h-5 rounded bg-slate-700"></span> <span>Not visited</span></div>
      <div class="flex items-center gap-3"><span class="w-5 h-5 rounded bg-rose-500"></span> <span>Not answered</span></div>
      <div class="flex items-center gap-3"><span class="w-5 h-5 rounded bg-emerald-500"></span> <span>Answered</span></div>
      <div class="flex items-center gap-3"><span class="w-5 h-5 rounded bg-violet-500"></span> <span>Marked for review</span></div>
    </div>
  </div>




  <!-- QUIZ SCREEN -->
  <div id="quizScreenWrapper" class="hidden w-full">
    <div id="quizScreen" class="grid grid-cols-1 md:grid-cols-[1fr,2fr] gap-6">

      <!-- LEFT SECTION -->
      <div class="space-y-4">
        <div class="flex items-center justify-between">
          <div class="text-xs">
            <div id="progressText" class="font-medium text-slate-200">Question 1 of 20</div>
            <div class="mt-1 w-44 h-1.5 bg-slate-800 rounded-full overflow-hidden">
              <div id="progressBar" class="h-full bg-indigo-400 rounded-full" style="width:5%"></div>
            </div>
          </div>
          <div id="timer" class="text-sm font-semibold text-rose-400">Time Left: 30m 00s</div>
        </div>

        <div class="p-4 rounded-xl bg-slate-900/70 border border-slate-700/80 max-h-[420px] overflow-y-auto">
          <div class="flex items-center justify-between mb-2 text-xs text-slate-400">
            <span>Question palette</span>
            <span id="answeredCountText">0 answered</span>
          </div>
          <div id="questionList" class="grid grid-cols-5 gap-2 text-xs"></div>
        </div>

        <button id="submitBtnTop" class="w-full rounded-xl bg-rose-500 hover:bg-rose-400 px-4 py-2 text-xs font-semibold text-white">
          Submit Test
        </button>
      </div>




      <!-- RIGHT SECTION -->
      <div class="space-y-4">
        <div class="p-6 rounded-xl bg-slate-900/70 border border-slate-700/80 shadow-inner min-h-[300px] flex flex-col gap-4">
          <div class="flex items-center justify-between text-xs text-slate-400">
            <span id="questionHeader">Question</span>
            <span id="statusText" class="text-slate-500"></span>
          </div>

          <div id="questionText" class="text-lg font-medium"></div>
          <div id="optionsContainer" class="space-y-3"></div>
        </div>

        <div class="flex items-center justify-between">
          <button id="markReviewBtn" class="px-3 py-2 rounded-xl border border-violet-500 text-violet-300 text-xs font-semibold hover:bg-violet-500/10">
            Mark for review
          </button>

          <div class="flex gap-3">
            <button id="prevBtn" class="px-4 py-2 rounded-xl bg-slate-800 text-xs font-semibold text-slate-100 hover:bg-slate-700 disabled:opacity-40">
              Previous
            </button>

            <button id="nextBtn" class="px-5 py-2 rounded-xl bg-indigo-500 text-xs font-semibold text-white hover:bg-indigo-400 disabled:opacity-40">
              Next
            </button>
          </div>
        </div>

        <span id="reviewStateText" class="text-xs text-violet-300"></span>
      </div>
    </div>
  </div>




  <!-- RESULT SCREEN -->
  <div id="resultScreen" class="hidden w-full mt-6">
    <div class="grid md:grid-cols-[2fr,1fr] gap-6">
      <div class="p-6 rounded-xl bg-slate-900/70 border border-slate-700">
        <h2 class="text-xl font-semibold mb-2">Quiz Submitted</h2>
        <p id="scoreText" class="hidden"></p>
        <p id="metaText" class="text-sm text-slate-300 mt-2 leading-6"></p>
      </div>

      <div class="flex flex-col items-center justify-center gap-4">
        <img id="qrCode" class="w-40 h-40 bg-white p-2 rounded-xl" alt="QR Code">
        <button id="reloadBtn" class="px-4 py-2 rounded-xl bg-slate-800 text-xs font-semibold hover:bg-slate-700">Close</button>
      </div>
    </div>
  </div>




  <div id="startActions" class="mt-4 flex justify-center">
    <button id="startBtn" class="px-6 py-3 bg-emerald-500 hover:bg-emerald-400 text-white font-semibold rounded-xl">
      Enter Fullscreen & Start Quiz
    </button>
  </div>

</div>






<script>
// ==========================================
// QUESTIONS WITH NUMBERS REMOVED (Option A)
// ==========================================

const questions = [

{ q:`In a competition, four different functions are observed.
All the functions use a single for loop and within the
loop, the same set of statements are executed. Consider
the following loops:
A) for(i = 0; i < n; i++)
B) for(i = 0; i < n; i += 2)
C) for(i = 1; i < n; i *= 2)
D) for(i = n; i > -1; i /= 2)
If n is the size of input (positive), which function is the
most efficient (completes fastest)?`,
options:["A","B","C","D"], a:2 },

{ q:`Which option provides the increasing order of complexity of functions f1, f2, f3 and f4?
f1(n) = 2^n, f2(n) = n^(3/2), f3(n) = n log n, f4(n) = n^(log n)`,
options:["f3, f2, f4, f1","f3, f2, f1, f4","f2, f3, f1, f4","f2, f3, f4, f1"], a:0 },

{ q:`You have an array int A[5][10] stored in row-major order,
base address = 2000, size of int = 4 bytes. What is the
address of A[3][4]?`,
options:["2120","2136","2096","2116"], a:1 },

{ q:`What is the time complexity of inserting at the end in
dynamic arrays?`,
options:["O(1)","O(n)","O(log n)","Either O(1) or O(n)"], a:3 },

{ q:`What is the minimum number of pointer assignments
required to insert a new node N immediately before an
existing node X in a non-empty Doubly Linked List,
assuming X is not the head and has a predecessor P?`,
options:["6","4","5","3"], a:1 },

{ q:`What is the total memory (in bytes) occupied by a
Singly Linked List with N nodes on a 64-bit architec-
ture? (Assume each node stores one int and one
pointer.)`,
options:["12N + 8","8N + 8","4N + 8","16N + 8"], a:0 },

{ q:`The result of evaluating the postfix expression
10 5 + 60 6 / * 8 −`,
options:["284","213","142","71"], a:2 },

{ q:`What is the primary practical disadvantage of a Linked
List implementation for a Queue ADT compared to an
optimized Array (Circular Buffer), especially for small
to moderate values of N?`,
options:["Requires O(N²) memory","Dequeue is O(N)","Poor cache locality","Head/tail overhead O(log N)"], a:2 },

{ q:`Which two traversals are NOT sufficient to construct a
unique binary tree?`,
options:["Inorder + Preorder","Inorder + Postorder","Preorder + Postorder","Level order + Inorder"], a:2 },

{ q:`A Red-Black Tree has a red parent and a red uncle.
After inserting a red node, what is the correct fix?`,
options:["Rotate","Recolor","Delete","Left rotate"], a:1 },

{ q:`What is the most suitable output?
for(i = 0; i > -1; i++);
cout << i;`,
options:["-1","Infinite loop","INT MIN","INT MAX"], a:2 },

{ q:`Which correctly compares first 3 characters of two
strings?`,
options:["s1.compare(3,s2)","s1.compare(0,3,s2)","s1.compare(s2,0,3)","s1.compare(3,0,s2)"], a:1 },

{ q:`Which statement is NOT true?
A) static member shared
B) friend function normal call
C) scope resolution overloaded
D) virtual base avoids duplication`,
options:[
"static member shared",
"friend function normal call",
"scope resolution overloaded",
"virtual base avoids duplication"
], a:2 },

{ q:`Which statements are true regarding C++?
i. Overloading gives capability
ii. Inheritance supports reusability
iii. Derived ctor runs before base
iv. Overloading is polymorphism`,
options:["i & ii","i, ii, iii","i, ii, iv","ii, iii, iv"], a:2 },

{ q:`Output?
operator== assigns instead of compares.`,
options:["Equal","Not Equal","Compilation error","Undefined"], a:0 },

{ q:`Output?
class D : public B, public C; obj.fun();`,
options:["A","Ambiguous","Error","UB"], a:1 },

{ q:`Which correctly defines aggregation?`,
options:["Independent","Child can't exist","Has-a independent","Only abstract"], a:2 },

{ q:`Output of constructor/destructor program?`,
options:["C C D C D C","C C C D D D","C C D C D D","C D C D C D"], a:2 },

{ q:`Which statement is TRUE? class Human { Heart* h; }`,
options:["Composition","Aggregation","Inheritance","Association"], a:1 },

{ q:`Output?
string s="abcdef"; cout<<s.substr(2,3);`,
options:["abc","cde","def","cd"], a:1 }
];




// ========================================================
// QUIZ LOGIC
// ========================================================

let quizQuestions = [];
let answers = [];
let review = [];
let visited = [];
let currentIndex = 0;
let timeLeft = 1800;
let timerId = null;
let submitted = false;




function shuffle(a){
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
}

function initQuiz(){
  quizQuestions = questions.map(q => ({
    q: q.q,
    options: [...q.options],
    a: q.a
  }));

  shuffle(quizQuestions);

  quizQuestions.forEach(q=>{
    const order=[0,1,2,3];
    shuffle(order);
    q.options = order.map(i=>q.options[i]);
    q.a = order.indexOf(q.a);
    q.order=[0,1,2,3];
  });

  answers = new Array(quizQuestions.length).fill(null);
  review = new Array(quizQuestions.length).fill(false);
  visited = new Array(quizQuestions.length).fill(false);

  currentIndex = 0;

  buildPalette();
  renderQuestion();
  updateAnsweredCount();
}




function buildPalette(){
  const list=document.getElementById("questionList");
  list.innerHTML="";
  quizQuestions.forEach((_,i)=>{
    const btn=document.createElement("button");
    btn.textContent=i+1;
    btn.className="w-10 h-10 rounded-lg bg-slate-800 border border-slate-600";
    btn.onclick=()=>{ if(!submitted){ currentIndex=i; renderQuestion(); }};
    list.appendChild(btn);
  });
}

function updatePalette(){
  document.querySelectorAll("#questionList button").forEach((btn,i)=>{
    btn.className="w-10 h-10 rounded-lg text-xs font-semibold flex items-center justify-center border";

    if(!visited[i]) btn.classList.add("bg-slate-800","border-slate-600","text-slate-200");
    else if(review[i]) btn.classList.add("bg-violet-500","text-white");
    else if(answers[i]===null) btn.classList.add("bg-rose-500","text-white");
    else btn.classList.add("bg-emerald-500","text-white");

    if(i===currentIndex) btn.classList.add("ring-2","ring-indigo-400");
  });
}




function renderQuestion(){
  visited[currentIndex]=true;
  const q=quizQuestions[currentIndex];

  document.getElementById("questionHeader").textContent =
    "Question " + (currentIndex+1);

  document.getElementById("questionText").textContent = q.q;

  const container=document.getElementById("optionsContainer");
  container.innerHTML="";

  q.order.forEach(idx=>{
    let lbl=document.createElement("label");
    lbl.className="flex items-center gap-3 p-3 rounded-xl border border-slate-700 bg-slate-900/60 cursor-pointer hover:border-indigo-400";

    let inp=document.createElement("input");
    inp.type="radio";
    inp.name="option";
    inp.value=idx;
    inp.checked=answers[currentIndex]===idx;
    inp.onclick=()=>{
      answers[currentIndex]=idx;
      updateAnsweredCount();
      updatePalette();
      updateStatus();
      document.getElementById("nextBtn").disabled=false;
    };

    let sp=document.createElement("span");
    sp.textContent=q.options[idx];

    lbl.appendChild(inp);
    lbl.appendChild(sp);
    container.appendChild(lbl);
  });

  document.getElementById("prevBtn").disabled = currentIndex===0;
  document.getElementById("nextBtn").textContent =
    currentIndex===quizQuestions.length-1 ? "Submit" : "Next";
  document.getElementById("nextBtn").disabled = answers[currentIndex]===null;

  updateProgress();
  updateStatus();
  updateReview();
  updatePalette();
}




function updateProgress(){
  let pct=((currentIndex+1)/quizQuestions.length)*100;
  document.getElementById("progressBar").style.width=pct+"%";
  document.getElementById("progressText").textContent =
    `Question ${currentIndex+1} of ${quizQuestions.length}`;
}

function updateAnsweredCount(){
  document.getElementById("answeredCountText").textContent =
    answers.filter(v=>v!==null).length + " answered";
}

function updateStatus(){
  document.getElementById("statusText").textContent =
    answers[currentIndex]!==null ? "Answered" : "Not answered";
}

function updateReview(){
  document.getElementById("reviewStateText").textContent =
    review[currentIndex] ? "Marked for review" : "";
}




// TIMER
function startTimer(){
  timerId=setInterval(()=>{
    let m=Math.floor(timeLeft/60);
    let s=timeLeft%60;

    document.getElementById("timer").textContent =
      `Time Left: ${m}m ${String(s).padStart(2,"0")}s`;

    if(timeLeft<=0){
      clearInterval(timerId);
      submitQuiz("Time Over");
    }

    timeLeft--;
  },1000);
}




// SUBMIT
function submitQuiz(reason){
  if(submitted) return;
  submitted=true;

  clearInterval(timerId);

  const taken=1800-timeLeft;
  const submittedAt=new Date().toLocaleString();

  document.getElementById("quizScreenWrapper").classList.add("hidden");
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("startActions").classList.add("hidden");
  document.getElementById("resultScreen").classList.remove("hidden");

  let score=0;
  quizQuestions.forEach((q,i)=>{ if(answers[i]===q.a) score+=2; });

  let attempted=answers.filter(v=>v!==null).length;
  let reviewed=review.filter(v=>v).length;

  document.getElementById("metaText").innerHTML =
    `Attempted: ${attempted}<br>
     Marked for review: ${reviewed}<br>
     Submitted at: ${submittedAt}<br>
     Time Taken: ${Math.floor(taken/60)}m ${taken%60}s`;

  let qr = encodeURIComponent(
    `Score:${score}/40 | Attempted:${attempted} | Review:${reviewed} | Time:${taken}s`
  );

  document.getElementById("qrCode").src =
    "https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=" + qr;

  document.getElementById("scoreText").classList.remove("hidden");
  document.getElementById("scoreText").textContent =
    `Score: ${score} / 40`;

  if(document.fullscreenElement) document.exitFullscreen().catch(()=>{});
}




// BUTTON HANDLERS
document.getElementById("startBtn").onclick = async ()=>{
  try{ await document.documentElement.requestFullscreen(); }catch{}
  document.getElementById("startScreen").classList.add("hidden");
  document.getElementById("startActions").classList.add("hidden");
  document.getElementById("quizScreenWrapper").classList.remove("hidden");

  initQuiz();
  startTimer();
};

document.getElementById("nextBtn").onclick = ()=>{
  if(answers[currentIndex]===null) review[currentIndex]=true;
  if(currentIndex===quizQuestions.length-1) submitQuiz("User");
  else{ currentIndex++; renderQuestion(); }
};

document.getElementById("prevBtn").onclick = ()=>{
  if(currentIndex>0){ currentIndex--; renderQuestion(); }
};

document.getElementById("markReviewBtn").onclick = ()=>{
  review[currentIndex]=!review[currentIndex];
  updateReview();
  updatePalette();
  if(currentIndex<quizQuestions.length-1){ currentIndex++; renderQuestion(); }
};

document.getElementById("submitBtnTop").onclick = ()=>submitQuiz("User");
document.getElementById("reloadBtn").onclick = ()=>location.reload();




// ANTI-CHEAT
document.addEventListener("visibilitychange", ()=>{
  if(document.hidden && !submitted) submitQuiz("Tab change");
});
document.addEventListener("fullscreenchange", ()=>{
  if(!document.fullscreenElement && !submitted)
    submitQuiz("Fullscreen exit");
});
document.addEventListener("contextmenu", e=>e.preventDefault());
document.addEventListener("copy", e=>e.preventDefault());
document.addEventListener("paste", e=>e.preventDefault());
document.addEventListener("cut", e=>e.preventDefault());
document.addEventListener("keydown", e=>{
  if(e.key==="F12") e.preventDefault();
  if(e.ctrlKey && e.shiftKey &&
     ["i","j","c"].includes(e.key.toLowerCase())) e.preventDefault();
});
</script>

</body>
</html>
